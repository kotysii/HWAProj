
from Functions.BMP_Preparation import *
import time
from matplotlib import pyplot as plt
import pickle
from mpl_toolkits.mplot3d import Axes3D

start_time = time.time() #time of start
file_location = ["/home/dan/DIPProj/images/rbcdemo.bmp", "/home/dan/DIPProj/images/ArtificialCircle.bmp","/home/dan/Pictures/tula.bmp","/home/dan/DIPProj/images/teste.bmp", "/home/dan/DIPProj/images/ImageProcessingDemo.bmp", "/home/dan/DIPProj/images/dot.bmp","/home/dan/DIPProj/images/artific4px.bmp"]
usedimage = file_location[6]

image_width, image_height, image_offset = image_props(usedimage) #file import function, returns 2d array of the grayscale image (from importfun)

# rgbimg = cv.imread(usedimage)
# cv.imshow("1",rgbimg)
# cv.waitKey(0)

##############
threshold = 128
radius_range = 3
radius_start = 1
##############

rgbimg = plt.imread(usedimage)
gimg = np.zeros((image_height,image_width))
thresimg = np.zeros((image_height,image_width))
edges = [] * image_width*image_height
#rgbimg[xcolumn][yrow]


#grayscale the image with MATPLOTLIB Method
#also mark edge points
n=0
while n<image_height-1:
    m=0
    while m<image_width-1:
        gimg[n][m] =int( ( int(rgbimg[n][m][0]) + int(rgbimg[n][m][1]) + int(rgbimg[n][m][2]) )  /  3)
        if gimg[n][m] < threshold:                        #difference with/without threshold maker is 297/196 seconds on tula.bmp (4000x6000)
            edges.append((m,n))
            thresimg[n][m] = 1 #threshold maker has no sig. impact on the runtime compared to without 297 seconds, vs
        m+=1
        print("Grayscaling yo:\t", int(100 * n / image_height), "%", end="\r")
    n+=1

# at point, two images made:
# thresimg, gimg

# plt.imshow(thresimg, cmap="gray", vmin=0, vmax=1)
# plt.show()


#creates kernels for convolution
# sobelx = np.zeros((3,3));
# sobelx[0][0] = -1;sobelx[0][1] = 0;sobelx[0][2] = 1
# sobelx[1][0] = -2;sobelx[1][1] = 0;sobelx[1][2] = 2
# sobelx[2][0] = -1;sobelx[2][1] = 0;sobelx[2][2] = 1

# sobely = np.zeros((3,3))
# sobely[0][0] = 1;sobely[0][1] = 2;sobely[0][2] = 1
# sobely[1][0] = 0;sobely[1][1] = 0;sobely[1][2] = 0
# sobely[2][0] = -1;sobely[2][1] = -2;sobely[2][2] = -1

#           #takes|kernel|image,         |height,      |width
# xsobelled = conv(sobelx,grayimagearray, image_height, image_width)
# ysobelled = conv(sobely,grayimagearray, image_height, image_width)

#msin = [0, 1, 0, -1]
#mcos = [1, 0, -1, 0]

#msin = [0,0.00999983333416666,0.0199986666933331,0.0299955002024957,0.0399893341866342,0.0499791692706783,0.0599640064794446,0.0699428473375328,0.0799146939691727,0.089878549198011,0.0998334166468282,0.109778300837175,0.119712207288919,0.129634142619695,0.139543114644237,0.149438132473599,0.159318206614246,0.169182349066996,0.179029573425824,0.188858894976501,0.198669330795061,0.2084598998461,0.218229623080869,0.227977523535188,0.237702626427135,0.247403959254523,0.257080551892155,0.266731436688831,0.276355648564114,0.285952225104836,0.29552020666134,0.305058636443444,0.314566560616118,0.324043028394868,0.333487092140814,0.342897807455451,0.35227423327509,0.361615431964962,0.370920469412983,0.380188415123161,0.389418342308651,0.398609327984423,0.40776045305957,0.416870802429211,0.425939465066,0.43496553411123,0.44394810696552,0.452886285379068,0.461779175541483,0.470625888171158,0.479425538604203,0.488177246882908,0.496880137843737,0.505533341204847,0.514135991653113,0.522687228930659,0.531186197920883,0.539632048733969,0.548023936791874,0.556361022912784,0.564642473395035,0.572867460100481,0.581035160537305,0.58914475794227,0.597195441362392,0.60518640573604,0.613116851973434,0.62098598703656,0.628793024018469,0.636537182221968,0.644217687237691,0.651833771021537,0.659384671971473,0.666869635003698,0.674287911628145,0.681638760023334,0.688921445110551,0.696135238627357,0.70327941920041,0.710353272417608,0.717356090899523,0.724287174370143,0.731145829726896,0.737931371109963,0.744643119970859,0.751280405140293,0.757842562895277,0.764328937025505,0.770738878898969,0.777071747526824,0.783326909627483,0.789503739689951,0.795601620036366,0.801619940883777,0.807558100405114,0.813415504789374,0.819191568300998,0.82488571333845,0.830497370491971,0.836025978600521,0.841470984807897,0.846831844618015,0.852108021949363,0.857298989188603,0.862404227243338,0.867423225594017,0.872355482344986,0.877200504274682,0.881957806884948,0.886626914449487,0.891207360061435,0.895698685680048,0.900100442176505,0.904412189378826,0.908633496115883,0.912763940260521,0.916803108771767,0.920750597736136,0.92460601240802,0.928368967249167,0.932039085967226,0.935616001553386,0.939099356319068,0.942488801931698,0.945783999449539,0.948984619355586,0.952090341590516,0.955100855584692,0.958015860289225,0.960835064206073,0.963558185417193,0.966184951612734,0.968715100118265,0.971148377921045,0.973484541695319,0.975723357826659,0.977864602435316,0.979908061398614,0.98185353037236,0.983700814811277,0.98544972998846,0.98710010101385,0.98865176285172,0.990104560337178,0.991458348191686,0.992712991037589,0.993868363411645,0.994924349777581,0.99588084453764,0.996737752043143,0.997494986604054,0.998152472497548,0.998710143975583,0.999167945271476,0.999525830605479,0.999783764189357,0.999941720229966,0.999999682931835,0.99995764649874,0.999815615134291,0.999573603041505,0.999231634421391,0.998789743470524,0.998247974377633,0.997606381319174,0.996865028453919,0.996023989916537,0.99508334981018,0.994043202198076,0.992903651094119,0.991664810452469,0.990326804156158,0.988889766004702,0.987353839700716,0.985719178835554,0.983985946873937,0.982154317137619,0.980224472788046,0.978196606808045,0.976070921982524,0.973847630878195,0.971526955822315,0.969109128880456,0.966594391833298,0.963982996152448,0.9612752029753,0.958471283078914,0.955571516852944,0.952576194271595,0.949485614864631,0.946300087687415,0.943019931290011,0.939645473685325,0.936177052316306,0.932615014022201,0.928959715003869,0.925211520788168,0.921370806191395,0.91743795528181,0.913413361341225,0.909297426825682,0.905090563325201,0.900793191522627,0.89640574115156,0.89192865095338,0.887362368633376,0.882707350815974,0.877964062999078,0.873132979507516,0.868214583445613,0.863209366648874,0.858117829634809,0.852940481552876,0.84767784013357,0.842330431636646,0.836898790798498,0.831383460778683,0.825784993105608,0.820103947621374,0.814340892425796,0.80849640381959,0.802571066246747,0.796565472236087,0.790480222342005,0.78431592508442,0.778073196887921,0.771752662020126,0.765354952529254,0.758880708180922,0.752330576394171,0.74570521217672,0.739005278059471,0.732231444030251,0.72538438746682,0.718464793069126,0.711473352790844,0.704410765770176,0.697277738259938,0.690074983556936,0.68280322193064,0.675463180551151,0.668055593416491,0.660581201279201,0.653040751572265,0.645434998334371,0.637764702134504,0.630030629995892,0.622233555319305,0.614374257805712,0.606453523378315,0.598472144103956,0.590430918113913,0.582330649524082,0.574172148354572,0.565956230448703,0.557683717391417,0.549355436427127,0.540972220376989,0.532534907555621,0.524044341687276,0.515501371821464,0.506906852248053,0.498261642411839,0.4895666068266,0.480822614988648,0.472030541289883,0.463191264930345,0.454305669830306,0.445374644541871,0.436399082160126,0.42737988023383,0.418317940675659,0.409214169672017,0.40006947759242,0.390884778898452,0.381660992052332,0.372399039425055,0.363099847204168,0.353764345301143,0.34439346725839,0.334988150155905,0.32554933451756,0.316077964217054,0.306574986383523,0.297041351306832,0.287478012342544,0.277885925816587,0.268266050929618,0.258619349661111,0.248946786673153,0.239249329213982,0.229527947021264,0.219783612225117,0.210017299250899,0.200229984721771,0.190422647361027,0.180596267894233,0.170751828951145,0.160890314967456,0.151012712086344,0.141120008059867,0.131213192150184,0.12129325503063,0.11136118868665,0.101417986316602,0.0914646422324368,0.0815021517602691,0.0715315111408433,0.0615537174299132,0.0515697683985346,0.0415806624332905,0.0315873984364539,0.021590975726096,0.0115923939361583,0.00159265291648683,-0.00840724736714906,-0.0184063069330538,-0.0284035258836042,-0.0383979045052354,-0.0483884433684146,-0.0583741434275801,-0.0683540061210478,-0.0783270334708653,-0.0882922281826076,-0.0982485937451087,-0.108195134530108,-0.118130855891818,-0.12805476426638,-0.137965867271227,-0.147863173804319,-0.157745694143249,-0.167612440044218,-0.177462424840861,-0.187294663542903,-0.19710817293467,-0.2069019716734,-0.21667508038738,-0.226426521773883,-0.236155320696897,-0.245860504284637,-0.255541102026832,-0.265196145871773,-0.274824670323124,-0.284425712536463,-0.293998312415568,-0.303541512708429,-0.313054359102971,-0.322535900322479,-0.331985188220734,-0.341401277876821,-0.35078322768962,-0.360130099471969,-0.369440958544477,-0.378714873828998,-0.38795091794173,-0.39714816728596,-0.406305702144417,-0.415422606771246,-0.424497969483583,-0.433530882752718,-0.442520443294852,-0.451465752161424,-0.460365914828998,-0.469220041288728,-0.478027246135343,-0.4867866486557,-0.495497372916845,-0.504158547853612,-0.512769307355724,-0.521328790354407,-0.529836140908493,-0.538290508290018,-0.546691047069287,-0.555036917199424,-0.56332728410037,-0.571561318742344,-0.579738197728743,-0.587857103378483,-0.595917223807764,-0.603917753011261,-0.611857890942719,-0.619736843594963,-0.627553823079294,-0.635308047704276,-0.642998742053909,-0.650625137065167,-0.658186470104905,-0.665681985046119,-0.673110932343562,-0.680472569108694,-0.687766159183974,-0.694990973216472,-0.702146288730806,-0.709231390201386,-0.716245569123971,-0.723188124086512,-0.7300583608393,-0.736855592364383,-0.743579138944275,-0.750228328229919,-0.756802495307928,-0.763300982767073,-0.769723140764024,-0.776068327088332,-0.782335907226653,-0.788525254426196,-0.794635749757397,-0.800666782175818,-0.806617748583241,-0.812488053887984,-0.81827711106441,-0.823984341211626,-0.829609173611371,-0.835151045785094,-0.840609403550195,-0.845983701075447,-0.851273400935575,-0.856477974165001,-0.861596900310741,-0.866629667484444,-0.871575772413588,-0.876434720491802,-0.881206025828326,-0.885889211296603,-0.890483808581989,-0.894989358228584,-0.899405409685178,-0.903731521350305,-0.907967260616405,-0.91211220391308,-0.916165936749455,-0.920128053755624,-0.923998158723188,-0.927775864644876,-0.931460793753243,-0.935052577558449,-0.938550856885108,-0.941955281908201,-0.945265512188063,-0.948481216704426,-0.951602073889516,-0.954627771660216,-0.957558007449271,-0.960392488235543,-0.963130930573317,-0.965773060620639,-0.968318614166707,-0.970767336658289,-0.973118983225174,-0.975373318704667,-0.977530117665097,-0.979589164428367,-0.981550253091516,-0.983413187547311,-0.98517778150386,-0.986843858503237,-0.988411251939131,-0.989879805073504,-0.991249371052267,-0.992519812919963,-0.993691003633465,-0.994762826074676,-0.995735173062245,-0.996607947362286,-0.997381061698093,-0.998054438758879,-0.998628011207499,-0.999101721687185,-0.999475522827284,-0.999749377247994,-0.999923257564101,-0.999997146387718,-0.999971036330025,-0.999844930002004,-0.999618840014185,-0.999292788975378,-0.998866809490414,-0.998340944156888,-0.997715245560893,-0.99698977627177,-0.996164608835841,-0.995239825769163,-0.994215519549271,-0.993091792605935,-0.991868757310913,-0.990546535966713,-0.98912526079437,-0.987605073920215,-0.98598612736167,-0.984268583012041,-0.982452612624333,-0.980538397794069,-0.978526129941139,-0.97641601029065,-0.974208249852809,-0.971903069401821,-0.969500699453809,-0.967001380243766,-0.964405361701531,-0.961712903426794,-0.958924274663139,-0.956039754271118,-0.953059630700368,-0.949984201960761,-0.946813775592609,-0.943548668635906,-0.940189207598628,-0.936735728424079,-0.933188576457298,-0.929548106410525,-0.925814682327732,-0.921988677548216,-0.918070474669267,-0.914060465507907,-0.90995905106171,-0.905766641468704,-0.901483655966355,-0.897110522849642,-0.892647679428235,-0.888095571982754,-0.883454655720153,-0.87872539472819,-0.873908261929022,-0.869003739031916,-0.864012316485074,-0.858934493426592,-0.853770777634543,-0.848521685476204,-0.843187741856417,-0.837769480165098,-0.832267442223901,-0.826682178232036,-0.821014246711247,-0.815264214449963,-0.809432656446619,-0.803520155852155,-0.797527303911704,-0.791454699905466,-0.785302951088781,-0.779072672631403,-0.772764487555987,-0.766379026675784,-0.759916928531561,-0.753378839327746,-0.746765412867812,-0.740077310488894,-0.733315200995657,-0.726479760593413,-0.719571672820508,-0.712591628479962,-0.705540325570392,-0.698418469216214,-0.691226771597126,-0.683965951876901,-0.676636736131457,-0.669239857276261,-0.661776054993037,-0.654246075655791,-0.646650672256183,-0.638990604328224,-0.631266637872321,-0.623479545278685,-0.615630105250086,-0.607719102723986,-0.599747328794043,-0.591715580631009,-0.583624661403007,-0.575475380195217,-0.567268551928968,-0.559004997280249,-0.550685542597638,-0.54231101981967,-0.533882266391644,-0.525400125181879,-0.516865444397429,-0.508279077499258,-0.499641883116902,-0.490954724962601,-0.482218471744932,-0.473433997081935,-0.464602179413757,-0.455723901914805,-0.44680005240543,-0.437831523263147,-0.428819211333396,-0.419764017839859,-0.410666848294341,-0.401528612406215,-0.392350223991454,-0.383132600881251,-0.373876664830236,-0.364583341424301,-0.355253559988043,-0.345888253491828,-0.336488358458504,-0.327054814869741,-0.317588566072035,-0.308090558682377,-0.298561742493594,-0.289003070379361,-0.279415498198926,-0.269799984701516,-0.260157491430468,-0.250488982627075,-0.240795425134159,-0.231077788299392,-0.221337043878359,-0.211574165937385,-0.201790130756129,-0.191985916729955,-0.182162504272095,-0.17232087571561,-0.162462015215154,-0.152586908648561,-0.142696543518258,-0.132791908852517,-0.12287399510655,-0.112943794063467,-0.103002298735097,-0.0930505032626889,-0.0830894028174964,-0.0731199935012631,-0.0631432722466119,-0.0531602367173561,-0.0431718852087287,-0.0331792165475568,-0.0231832299923786,-0.0131849251335213,-0.00318530179313799]
#mcos = [1,0.999950000416665,0.999800006666578,0.999550033748988,0.999200106660978,0.998750260394966,0.998200539935204,0.99755100025328,0.996801706302619,0.995952733011994,0.995004165278026,0.993956097956697,0.992808635853866,0.991561893714788,0.990215996212637,0.988771077936042,0.987227283375627,0.985584766909561,0.983843692788121,0.98200423511727,0.980066577841242,0.978030914724148,0.975897449330606,0.973666395005375,0.97133797485203,0.968912421710645,0.966389978134513,0.963770896365891,0.961055438310771,0.958243875512697,0.955336489125606,0.952333569885713,0.949235418082441,0.946042343528387,0.942754665528346,0.939372712847379,0.935896823677935,0.932327345606035,0.92866463557651,0.924909059857313,0.921060994002885,0.917120822816605,0.913088940312308,0.908965749674885,0.904751663219964,0.900447102352677,0.896052497525525,0.891568288195329,0.886994922779284,0.882332858610122,0.877582561890373,0.872744507645751,0.86781917967765,0.862807070514761,0.857708681363824,0.852524522059506,0.847255111013416,0.841900975162269,0.836462649915187,0.830940679100164,0.825335614909678,0.81964801784548,0.813878456662534,0.808027508312152,0.802095757884293,0.796083798549056,0.789992231497365,0.783821665880849,0.777572718750928,0.771246014997107,0.764842187284488,0.758361875990508,0.751805729140895,0.74517440234487,0.738468558729588,0.731688868873821,0.724836010740905,0.717910669610943,0.710913538012277,0.703845315652236,0.696706709347165,0.689498432951747,0.682221207287614,0.674875760071267,0.667462825841308,0.659983145884982,0.652437468164052,0.644826547240001,0.63715114419858,0.629412026573697,0.621609968270664,0.613745749488812,0.605820156643463,0.597833982287298,0.589788025031098,0.581683089463884,0.573519986072457,0.565299531160354,0.557022546766217,0.548689860581588,0.54030230586814,0.531860721374356,0.52336595125165,0.514818844969955,0.506220257232778,0.497571047891727,0.488872081860528,0.480124229028534,0.47132836417374,0.462485366875301,0.453596121425577,0.444661516741707,0.435682446276712,0.426659807930157,0.417594503958358,0.408487440884157,0.399339529406273,0.39015168430823,0.380924824366882,0.371659872260533,0.362357754476674,0.35301940121933,0.343645746316047,0.334237727124503,0.324796284438776,0.315322362395269,0.305816908378289,0.296280872925319,0.286715209631956,0.277120875056558,0.267498828624587,0.25785003253267,0.248175451652373,0.238476053433723,0.228752807808459,0.219006687093042,0.209238665891419,0.199449720997573,0.189640831297834,0.179812977672999,0.169967142900241,0.160104311554831,0.150225469911686,0.140331605846737,0.130423708738146,0.120502769367367,0.11056977982007,0.100625733386932,0.0906716244643097,0.0807084484548006,0.0707372016677029,0.0607588812193859,0.0507744849335792,0.040785011241591,0.0307914590824661,0.0207948278030924,0.0107961170582674,0.000796326710733263,-0.00920354326880834,-0.0192024929016927,-0.0291995223012888,-0.0391936317729877,-0.0491838219141706,-0.0591690937141484,-0.0691484486540622,-0.0791208888067341,-0.0890854169364592,-0.099041036598728,-0.108986752239871,-0.118921569296612,-0.128844494295525,-0.138754534952378,-0.148650700271364,-0.158532000644198,-0.168397447949077,-0.178246055649492,-0.18807683889288,-0.197888814609109,-0.207681001608784,-0.217452420681365,-0.227202094693087,-0.236929048684675,-0.246632309968834,-0.256310908227523,-0.26596387560898,-0.275590246824513,-0.285189059245021,-0.294759352997261,-0.304300171059833,-0.313810559358882,-0.323289566863504,-0.332736245680845,-0.342149651150898,-0.35152884194096,-0.360872880139767,-0.370180831351287,-0.379451764788155,-0.388684753364752,-0.397878873789916,-0.407033206659266,-0.416146836547142,-0.425218852098153,-0.434248346118301,-0.443234415665709,-0.452176162140912,-0.461072691376713,-0.469923113727602,-0.47872654415872,-0.487482102334359,-0.496188912705999,-0.504846104599858,-0.513452812303959,-0.522008175154707,-0.530511337622945,-0.538961449399512,-0.547357665480271,-0.555699146250613,-0.56398505756941,-0.572214570852437,-0.580386863155222,-0.588501117255346,-0.59655652173416,-0.60455227105793,-0.612487565658385,-0.62036161201268,-0.628173622722739,-0.635922816594003,-0.643608418713541,-0.651229660527546,-0.658785779918188,-0.666276021279824,-0.673699635594561,-0.681055880507153,-0.688344020399238,-0.695563326462902,-0.702713076773554,-0.709792556362121,-0.716801057286543,-0.723737878702569,-0.730602326933837,-0.737393715541245,-0.744111365391593,-0.750754604725491,-0.757322769224544,-0.763815202077774,-0.770231254047307,-0.776570283533293,-0.782831656638065,-0.789014747229531,-0.795118937003784,-0.801143615546934,-0.807088180396146,-0.81295203709989,-0.818734599277382,-0.824435288677222,-0.830053535235222,-0.835588777131408,-0.841040460846201,-0.846408041215776,-0.851690981486566,-0.856888753368947,-0.862000837090064,-0.867026721445802,-0.871965903851917,-0.876817890394282,-0.881582195878286,-0.886258343877352,-0.890845866780576,-0.895344305839492,-0.899753211213941,-0.904072142017061,-0.90830066635937,-0.912438361391958,-0.916484813348769,-0.920439617587981,-0.924302378632464,-0.928072710209333,-0.931750235288572,-0.935334586120739,-0.938825404273736,-0.942222340668658,-0.945525055614696,-0.948733218843107,-0.951846509540242,-0.954864616379626,-0.95778723755309,-0.960614080800952,-0.963344863441243,-0.965979312397975,-0.968517164228447,-0.970958165149591,-0.973302071063349,-0.975548647581083,-0.977697670047013,-0.979748923560684,-0.981702202998454,-0.983557313034006,-0.985314068157884,-0.986972292696038,-0.988531820827396,-0.989992496600445,-0.991354173948826,-0.992616716705937,-0.993779998618556,-0.99484390335946,-0.995808324539061,-0.996673165716047,-0.997438340407019,-0.998103772095146,-0.998669394237814,-0.99913515027328,-0.999500993626328,-0.999766887712928,-0.999932805943894,-0.99999873172754,-0.999964658471342,-0.999830589582598,-0.999596538468086,-0.999262528532721,-0.998828593177219,-0.998294775794753,-0.997661129766618,-0.996927718456887,-0.996094615206081,-0.99516190332383,-0.994129676080546,-0.992998036698093,-0.991767098339465,-0.990436984097473,-0.989007826982433,-0.987479769908865,-0.985852965681203,-0.984127576978515,-0.982303776338232,-0.980381746138899,-0.978361678581934,-0.97624377567241,-0.974028249198852,-0.971715320712062,-0.969305221502961,-0.966798192579461,-0.964194484642366,-0.961494358060299,-0.958698082843669,-0.955805938617666,-0.952818214594305,-0.949735209543496,-0.946557231763177,-0.943284599048476,-0.939917638659938,-0.936456687290796,-0.932902091033304,-0.929254205344123,-0.925513395008784,-0.921680034105203,-0.917754505966276,-0.913737203141545,-0.909628527357944,-0.90542888947963,-0.901138709466888,-0.896758416334147,-0.892288448107068,-0.88772925177875,-0.883081283265026,-0.878345007358874,-0.873520897683938,-0.868609436647165,-0.863611115390566,-0.858526433742102,-0.853355900165699,-0.848100031710408,-0.842759353958693,-0.83733440097388,-0.831825715246746,-0.826233847641272,-0.820559357339561,-0.814802811785912,-0.808964786630086,-0.803045865669731,-0.797046640792012,-0.790967711914417,-0.784809686924768,-0.778573181620432,-0.772258819646744,-0.765867232434637,-0.759399059137508,-0.752854946567295,-0.746235549129803,-0.739541528759258,-0.732773554852121,-0.72593230420014,-0.719018460922681,-0.71203271639831,-0.704975769195658,-0.697848325003563,-0.690651096560508,-0.683384803583336,-0.676050172695292,-0.668647937353351,-0.66117883777488,-0.653643620863612,-0.646043040134959,-0.63837785564066,-0.630648833892775,-0.622856747787042,-0.615002376525574,-0.607086505538955,-0.599109926407685,-0.591073436783031,-0.582977840307259,-0.574823946533269,-0.566612570843644,-0.55834453436911,-0.550020663906424,-0.541641791835698,-0.533208756037154,-0.524722399807346,-0.516183571774825,-0.507593125815277,-0.49895192096614,-0.490260821340699,-0.481520696041673,-0.472732419074309,-0.46389686925898,-0.455014930143305,-0.446087489913793,-0.437115441307028,-0.428099681520394,-0.419041112122356,-0.409940638962306,-0.400799172079975,-0.391617625614435,-0.38239691771268,-0.373137970437818,-0.363841709676858,-0.354509065048131,-0.345140969808323,-0.335738360759151,-0.326302178153684,-0.316833365602318,-0.307332869978419,-0.297801641323633,-0.288240632752882,-0.278650800359055,-0.269033103117399,-0.259388502789626,-0.249717963827731,-0.240022453277549,-0.230302940682059,-0.220560397984419,-0.21079579943078,-0.20101012147286,-0.191204342670301,-0.181379443592811,-0.171536406722112,-0.161676216353686,-0.151799858498355,-0.141908320783673,-0.13200259235517,-0.122083663777433,-0.112152526935054,-0.102210174933442,-0.0922576019995117,-0.0822958033822624,-0.0723257752532536,-0.0623485146069917,-0.0523650191612259,-0.0423762872571815,-0.0323833177597247,-0.0223871099574771,-0.0123886634628906,-0.00238897811228154,0.00761094613414879,0.0176101092923073,0.0276075114542115,0.0376021528879766,0.0475930341377878,0.0575791561238469,0.0675595202422752,0.0775331284649787,0.0874989834394473,0.0974560885884866,0.10740344820988,0.117340067575955,0.127264953033056,0.137177112100908,0.147075553571863,0.156959287610023,0.166827325850222,0.176678681496858,0.186512369422576,0.196327406266778,0.206122810533958,0.215897602691854,0.225650805269396,0.235381442954451,0.245088542691362,0.254771133778244,0.264428247964056,0.274058919545427,0.283662185463226,0.293237085398863,0.302782661870324,0.312297960327916,0.321782029249722,0.331233920236755,0.34065268810779,0.350037390993891,0.35938709043259,0.368700851461733,0.377977742712981,0.387216836504937,0.396417208935922,0.405577939976361,0.414698113560783,0.423776817679428,0.432813144469452,0.441806190305705,0.450755055891099,0.459658846346532,0.468516671300377,0.477327644977522,0.486090886287941,0.494805518914805,0.503470671402114,0.512085477241841,0.520649074960579,0.529160608205696,0.537619225830956,0.546024081981648,0.554374336179162,0.562669153405033,0.570907704184454,0.579089164669211,0.587212716720073,0.595277547988607,0.603282851998404,0.611227828225735,0.619111682179599,0.62693362548117,0.634692875942635,0.642388657645414,0.650020201017752,0.65758674291167,0.665087526679283,0.672521802248466,0.679888826197857,0.687187861831201,0.694418179251016,0.701579055431586,0.70866977429126,0.715689626764061,0.722637910870592,0.729513931788232,0.736317001920619,0.743046440966411,0.749701575987308,0.756281741475356,0.762786279419489,0.769214539371333,0.77556587851025,0.781839661707619,0.788035261590348,0.794152058603611,0.800189441072806,0.806146805264716,0.812023555447886,0.817819103952195,0.823532871227622,0.829164285902202,0.83471278483916,0.840177813193225,0.845558824466117,0.850855280561193,0.856066651837255,0.861192417161521,0.866232063961728,0.871185088277398,0.876050994810224,0.880829296973609,0.885519516941319,0.890121185695266,0.894633843072408,0.899057037810768,0.903390327594559,0.907633279098414,0.911785468030717,0.915846479176035,0.919815906436639,0.92369335287311,0.927478430744036,0.931170761544783,0.934769976045349,0.938275714327283,0.941687625819678,0.945005369334228,0.948228613099346,0.951357034793342,0.954390321576654,0.957328170123131,0.960170286650366,0.962916386949075,0.965566196411518,0.968119450058955,0.970575892568149,0.972935278296897,0.975197371308593,0.977361945395819,0.979428784102971,0.981397680747901,0.983268438442585,0.985040870112812,0.986714798516892,0.98829005626338,0.989766485827815,0.991143939568469,0.992422279741117,0.993601378512806,0.994681117974643,0.995661390153581,0.996542097023218,0.997323150513601,0.998004472520033,0.998585994910881,0.99906765953439,0.999449418224499,0.999731232805658,0.999913075096642,0.999994926913375]

msin = [0,0.0998334166468282,0.198669330795061,0.29552020666134,0.389418342308651,0.479425538604203,0.564642473395036,0.644217687237691,0.717356090899523,0.783326909627483,0.841470984807897,0.891207360061435,0.932039085967226,0.963558185417193,0.98544972998846,0.997494986604054,0.999573603041505,0.991664810452469,0.973847630878195,0.946300087687415,0.909297426825682,0.863209366648874,0.80849640381959,0.74570521217672,0.675463180551151,0.598472144103956,0.515501371821464,0.42737988023383,0.334988150155905,0.239249329213982,0.141120008059867,0.0415806624332905,-0.0583741434275801,-0.157745694143248,-0.255541102026831,-0.35078322768962,-0.442520443294852,-0.529836140908493,-0.611857890942719,-0.687766159183974,-0.756802495307928,-0.81827711106441,-0.871575772413588,-0.916165936749455,-0.951602073889516,-0.977530117665097,-0.993691003633464,-0.999923257564101,-0.996164608835841,-0.982452612624333,-0.958924274663139,-0.925814682327733,-0.883454655720153,-0.832267442223901,-0.772764487555987,-0.705540325570392,-0.631266637872322,-0.550685542597638,-0.464602179413757,-0.373876664830236,-0.279415498198926,-0.182162504272095,-0.0830894028174964]
mcos = [1,0.995004165278026,0.980066577841242,0.955336489125606,0.921060994002885,0.877582561890373,0.825335614909678,0.764842187284488,0.696706709347165,0.621609968270664,0.54030230586814,0.453596121425577,0.362357754476673,0.267498828624587,0.169967142900241,0.0707372016677029,-0.0291995223012888,-0.128844494295525,-0.227202094693087,-0.323289566863504,-0.416146836547142,-0.504846104599858,-0.588501117255346,-0.666276021279824,-0.737393715541246,-0.801143615546934,-0.856888753368947,-0.904072142017061,-0.942222340668658,-0.970958165149591,-0.989992496600445,-0.99913515027328,-0.998294775794753,-0.987479769908865,-0.966798192579461,-0.936456687290796,-0.896758416334147,-0.848100031710408,-0.790967711914417,-0.72593230420014,-0.653643620863612,-0.574823946533269,-0.490260821340699,-0.400799172079975,-0.307332869978419,-0.21079579943078,-0.112152526935055,-0.0123886634628906,0.0874989834394464,0.186512369422576,0.283662185463226,0.37797774271298,0.468516671300377,0.554374336179161,0.634692875942635,0.70866977429126,0.77556587851025,0.83471278483916,0.885519516941319,0.927478430744036,0.960170286650366,0.983268438442585,0.996542097023218]



#creates an array of accumulator planes
# accumulator = []
# plane = np.zeros((image_height,image_width))
# n=0
# while n<radius_range:
#     np.append(accumulator, plane)
#     n+=1

accumulator = np.ndarray(shape=(radius_range,image_height,image_width), dtype=int)
#   accumulator[r][h][w]

circle_coords = []

edgeslength = len(edges)
print("%s edges to evaluate, so be patient" %edgeslength)
print("radius range of %s" %radius_range)

# for every edge point:
# draw circle (circle_coords)
#   for every coordinate in that circle
#   set accumulator to 1
# next edge point
# TODO have resolution of Sin/Cos change according to the the radius
# TODO does the high resolution of a sin and cos mean places are iterating multiple times. Therefore different radius have different voting weighting?!
i=0
r = radius_start
rar = 0

while rar < radius_range:
    for p in edges:
        i += 1
        x,y = p
        circle_coords = (circle(msin,mcos,x,y,r)) #takes msin,mcos,a,b,r in pixels, returns the coordinates of a circle of r radius about the points x, y
        for n in circle_coords:
            h, v = n
            if (h < image_width) & (h>0) & (v < image_height) & (v>0):
                accumulator[rar][v][h] += 1
        print("Houghing: ", 100 * i / edgeslength, "%", end="\r")
    r += 1
    rar+=1
print("Houghed!")

maxi = np.amax(accumulator) #max value in array
print("\n")
print(maxi)
print("\n")

#   MAKES A 3D Plot #Couldnt get to work because something with my array being different to the array below? dunno bro, dunno
# filled = np.array([
#     [[1, 0, 1], [0, 0, 1], [0, 1, 0]],
#     [[0, 1, 1], [1, 0, 0], [1, 0, 1]],
#     [[1, 1, 0], [1, 1, 1], [0, 0, 0]]
# ])

#
def make_ax(grid=False):
    fig = plt.figure()
    ax = fig.gca(projection='3d')
    ax.set_xlabel("x")
    ax.set_ylabel("y")
    ax.set_zlabel("z")
    ax.grid(True)
    return ax
print("Making Axes")
ax = make_ax(True)
print("Making Voxels")
ax.voxels(accumulator, facecolors='#1f77b430', edgecolors='gray')
print("Showing")
plt.show()
print("4")

# END OF 3D Maker

print("\n\nRuntime: %s seconds" %(time.time()-start_time))

